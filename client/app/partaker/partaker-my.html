<partaker-my show="{show}">
	<div class="par1">
		<on-scroll
			if="{opts.partakers && opts.partakers.items.length}"
			infinite-scroll='{nextPage}'
			infinite-scroll-disabled='{opts.partakers.busy}'
			infinite-scroll-distance='{100}'
		>	
			<div style="margin-bottom: 10px;" each="{partaker in parent.opts.partakers.items}">
				<div class="par2">
					<a href="/group/_{partaker.group.id}"  target-for-android style="color:#595757;">
						<div style="margin-top: 10px;">
							<p class="par3" if="{!partaker.group.isBefore}">已结束</p>
							<p class="par4" if="{partaker.group.isBefore}"><span>剩余时间:</span><span am-time-ago="partaker.group.time_end">0</span></p>
							<!--{{partaker.commodity.status.model}}-->
							<!--普通团分享团右上状态-->
							<p class="rightb" if="{partaker.group.isBefore&&partaker.commodity.status.model === 'share'}">{partaker.commodity.partakers>partaker.group.num_order?'还差'+(partaker.commodity.partakers-partaker.group.num_order)+'人成团':'已成团'}</p>
							<!--普通团佣金团右上状态-->
							<p class="rightb" if="{partaker.group.isBefore&&partaker.commodity.status.model === 'distribution'}">{partaker.commodity.partakers>partaker.group.num_order?'还差'+(partaker.commodity.partakers-partaker.group.num_order)+'人成团':'已成团'}</p>
							<!--阶梯团右上状态-->
							<p class="rightb" if="{partaker.group.isBefore&&partaker.commodity.status.model === 'ladder'}">{partaker.commodity.partakers>partaker.group.num_order?partaker.group.num_order+'人已参团(阶梯团)':'已成团'}</p>
						</div>
						<div class="media media-order">
							<div class="media-left">
								<img style="border-radius: 3px;width: 110px;" class="media-object" riot-src="{'http://img1.ifindu.cn/crop/w_430/h_310'+ partaker.commodity.cover}" if="{partaker.commodity.cover}">
								<img style="border-radius: 3px;width: 110px;" class="media-object" holder="holder.js/120x85?theme=gray&text=91拼团" class="img-responsive" if="{!partaker.commodity.cover}">
							</div>
							<div class="media-body1">
								<p class="media-heading1">{partaker.commodity.name}</p>
								<div style="font-size: 14px;color: #231815;">团长：{partaker.group.user.name}</div>
								<div class="word-break">
									开团时间:{$.util.filter.date(new Date(partaker.time_join), 'yyyy-MM-dd')}
								</div>
							</div>
						</div>
					</a>
				</div>
			</div>
		</div>
	</div>

	<script>
		import {connect} from 'riot-redux';
		import actions from './partaker.actions';
		connect(
			state => ({
				partakers: state.partakers
			}),
			dispatch => ({
				nextPage: (params, done) => dispatch(actions.partakersNextPage(params, done)) 
			})
		)(this);
		this.mixin('router');
		this.$use(function(next){
			context.store.dispatch({type: 'resetPartakers'});
			next();
		})
		this.nextPage = () => this.opts.nextPage({my: true})
	</script>
</partaker-my>